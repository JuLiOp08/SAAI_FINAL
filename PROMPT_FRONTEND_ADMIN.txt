# PROMPT PARA IA - FRONTEND SAAI ADMIN (React Web)

## ğŸ¯ CONTEXTO DEL PROYECTO

Estoy desarrollando una aplicaciÃ³n web React para **ADMINISTRADORES DE TIENDA** del sistema SAAI (Smart Assistant for Inventory). Esta es la app mÃ¡s completa de las 3 del ecosistema.

**Rol del usuario:** ADMINISTRADOR/ADMIN
- Permisos COMPLETOS: Productos, ventas, usuarios, gastos, analÃ­tica, reportes, predicciones ML, notificaciones
- Es el dueÃ±o de la tienda, tiene acceso total excepto gestiÃ³n de otras tiendas

**Backend:** AWS Serverless (API Gateway + Lambda + DynamoDB)
- AutenticaciÃ³n: JWT (Bearer token) - el token se envÃ­a en CADA request
- Multi-tenant: Cada admin pertenece a UNA tienda (tenant_id extraÃ­do del JWT por el backend)
- WebSockets: Notificaciones y actualizaciones en tiempo real
- S3: Descarga de reportes CSV (presigned URLs que expiran en 1h)
- ML: PredicciÃ³n de demanda con Holt-Winters (Docker Lambda)

**Frontend:** React + Vite + Tailwind CSS + Chart.js
- Tailwind CSS para estilos (ya configurado en package.json)
- React Router para navegaciÃ³n
- Axios para llamadas API
- Context API para estado global
- Chart.js o Recharts para grÃ¡ficos analÃ­ticos

---

## ğŸ“š ARCHIVOS DE REFERENCIA OBLIGATORIOS

**IMPORTANTE:** Antes de escribir cualquier cÃ³digo, debes leer y entender completamente estos documentos:

### 1. SAAI_oficial.txt
- **SecciÃ³n crÃ­tica:** "3. Arquitectura ADMINISTRADOR"
  - 3.1 Endpoints (Request/Response) - LÃ­neas 712-1310
  - 3.2 Lambdas (quÃ© hace cada una) - LÃ­neas 1312-1750
- **Convenciones del backend:** LÃ­neas 1-80
- **IMPORTANTE:** Leer secciÃ³n de AnalÃ­tica (ActualizarAnalitica es SOLO EventBridge, frontend usa VerAnalitica)

### 2. SAAI_resumen_tecnico.txt
- Arquitectura de AnalÃ­tica y SNS
- Predicciones ML (Holt-Winters, Docker Lambda)
- Reportes en S3 con presigned URLs
- WebSockets para eventos en tiempo real

### 3. SAAI_Backend_Complete.postman_collection.json
- **MÃ³dulos relevantes para ADMIN:**
  - 1. AUTH â†’ Login Admin
  - 2. USUARIOS â†’ CRUD completo
  - 3. PRODUCTOS â†’ CRUD completo
  - 4. VENTAS â†’ Registrar, listar, buscar
  - 5. GASTOS â†’ CRUD completo
  - 6. ANALYTICS â†’ Ver AnalÃ­tica (NO actualizar manualmente)
  - 7. REPORTES â†’ Generar 4 tipos, listar historial
  - 8. PREDICCIONES ML â†’ Predecir demanda
  - 9. NOTIFICACIONES â†’ Listar

---

## ğŸ—ï¸ ESTRUCTURA DE LA APP

```
saai-admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ LoginPage.jsx
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â””â”€â”€ DashboardPage.jsx          # Vista general con KPIs
â”‚   â”‚   â”œâ”€â”€ productos/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductosPage.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EditarProductoPage.jsx
â”‚   â”‚   â”‚   â””â”€â”€ BuscarProductosPage.jsx
â”‚   â”‚   â”œâ”€â”€ ventas/
â”‚   â”‚   â”‚   â”œâ”€â”€ RegistrarVentaPage.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ VentasPage.jsx
â”‚   â”‚   â”‚   â””â”€â”€ BuscarVentasPage.jsx
â”‚   â”‚   â”œâ”€â”€ usuarios/
â”‚   â”‚   â”‚   â”œâ”€â”€ UsuariosPage.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EditarUsuarioPage.jsx
â”‚   â”‚   â”‚   â””â”€â”€ BuscarUsuariosPage.jsx
â”‚   â”‚   â”œâ”€â”€ gastos/
â”‚   â”‚   â”‚   â”œâ”€â”€ GastosPage.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ EditarGastoPage.jsx
â”‚   â”‚   â”‚   â””â”€â”€ BuscarGastosPage.jsx
â”‚   â”‚   â”œâ”€â”€ analitica/
â”‚   â”‚   â”‚   â””â”€â”€ AnaliticaPage.jsx          # Dashboard analÃ­tico con grÃ¡ficos
â”‚   â”‚   â”œâ”€â”€ reportes/
â”‚   â”‚   â”‚   â”œâ”€â”€ GenerarReportesPage.jsx
â”‚   â”‚   â”‚   â””â”€â”€ HistorialReportesPage.jsx
â”‚   â”‚   â”œâ”€â”€ predicciones/
â”‚   â”‚   â”‚   â””â”€â”€ PrediccionDemandaPage.jsx
â”‚   â”‚   â””â”€â”€ notificaciones/
â”‚   â”‚       â””â”€â”€ NotificacionesPage.jsx
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Navbar.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.jsx                # MenÃº con 9 mÃ³dulos
â”‚   â”‚   â”‚   â””â”€â”€ Layout.jsx
â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Modal.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Table.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Badge.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Tabs.jsx
â”‚   â”‚   â”‚   â””â”€â”€ Spinner.jsx
â”‚   â”‚   â”œâ”€â”€ charts/                         # GrÃ¡ficos para analÃ­tica
â”‚   â”‚   â”‚   â”œâ”€â”€ LineChart.jsx               # Ventas diarias
â”‚   â”‚   â”‚   â”œâ”€â”€ BarChart.jsx                # Productos top
â”‚   â”‚   â”‚   â””â”€â”€ PieChart.jsx                # DistribuciÃ³n ventas
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ KPICard.jsx                 # Tarjetas mÃ©tricas
â”‚   â”‚   â”‚   â””â”€â”€ AlertCard.jsx
â”‚   â”‚   â”œâ”€â”€ productos/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCard.jsx
â”‚   â”‚   â”‚   â””â”€â”€ ProductForm.jsx
â”‚   â”‚   â”œâ”€â”€ ventas/
â”‚   â”‚   â”‚   â”œâ”€â”€ VentaCard.jsx
â”‚   â”‚   â”‚   â””â”€â”€ VentaForm.jsx
â”‚   â”‚   â”œâ”€â”€ usuarios/
â”‚   â”‚   â”‚   â”œâ”€â”€ UsuarioCard.jsx
â”‚   â”‚   â”‚   â””â”€â”€ UsuarioForm.jsx
â”‚   â”‚   â”œâ”€â”€ gastos/
â”‚   â”‚   â”‚   â”œâ”€â”€ GastoCard.jsx
â”‚   â”‚   â”‚   â””â”€â”€ GastoForm.jsx
â”‚   â”‚   â””â”€â”€ reportes/
â”‚   â”‚       â””â”€â”€ ReporteCard.jsx
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api.js
â”‚   â”‚   â”œâ”€â”€ auth.service.js
â”‚   â”‚   â”œâ”€â”€ productos.service.js
â”‚   â”‚   â”œâ”€â”€ ventas.service.js
â”‚   â”‚   â”œâ”€â”€ usuarios.service.js
â”‚   â”‚   â”œâ”€â”€ gastos.service.js
â”‚   â”‚   â”œâ”€â”€ analitica.service.js
â”‚   â”‚   â”œâ”€â”€ reportes.service.js
â”‚   â”‚   â”œâ”€â”€ predicciones.service.js
â”‚   â”‚   â””â”€â”€ websocket.service.js
â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”œâ”€â”€ AuthContext.jsx
â”‚   â”‚   â”œâ”€â”€ AnaliticaContext.jsx        # Estado analÃ­tica + WS
â”‚   â”‚   â””â”€â”€ NotificationContext.jsx
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useAuth.js
â”‚   â”‚   â”œâ”€â”€ useWebSocket.js
â”‚   â”‚   â””â”€â”€ usePagination.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ constants.js
â”‚   â”‚   â”œâ”€â”€ helpers.js
â”‚   â”‚   â””â”€â”€ chartHelpers.js            # Formateo datos grÃ¡ficos
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ AppRoutes.jsx
â”‚   â”‚   â””â”€â”€ ProtectedRoute.jsx
â”‚   â””â”€â”€ App.jsx
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ vite.config.js
â””â”€â”€ package.json
```

---

## ğŸš€ ORDEN DE IMPLEMENTACIÃ“N SUGERIDO

### FASE 1: AutenticaciÃ³n y NavegaciÃ³n Base (COMENZAR AQUÃ)
1. **LoginScreen + AuthContext**
   - POST /login (admin)
   - Guardar token + user info en AsyncStorage
   - NavegaciÃ³n a DashboardScreen

2. **API Service + Interceptors**
   - Axios con Authorization header
   - Error handling 401 â†’ logout
   - Error handling genÃ©rico

3. **DrawerNavigator**
   - MenÃº lateral con mÃ³dulos: Dashboard, Productos, Ventas, Usuarios, Gastos, AnalÃ­tica, Reportes, Predicciones, Notificaciones
   - Header con nombre de tienda y logout

### FASE 2: Productos + Ventas (Herencia de TRABAJADOR)
4. **MÃ³dulo Productos** (igual que TRABAJADOR)
   - ListaProductosScreen
   - CrearProductoScreen
   - EditarProductoScreen
   - BuscarProductosScreen

5. **MÃ³dulo Ventas** (igual que TRABAJADOR)
   - RegistrarVentaScreen
   - ListaVentasScreen
   - BuscarVentasScreen

### FASE 3: Usuarios (Exclusivo ADMIN)
6. **ListaUsuariosScreen**
   - GET /usuarios con paginaciÃ³n
   - Mostrar: cÃ³digo, nombre, email, rol (admin/worker), estado

7. **CrearUsuarioScreen**
   - POST /usuarios
   - Formulario: nombre, email, password, rol
   - ValidaciÃ³n de email Ãºnico

8. **EditarUsuarioScreen**
   - PUT /usuarios/{codigo_usuario}
   - Cambiar nombre, email, rol, estado
   - NO cambiar password (feature separada)

9. **BuscarUsuariosScreen**
   - POST /usuarios/buscar
   - BÃºsqueda por: nombre, email, cÃ³digo

### FASE 4: Gastos (Exclusivo ADMIN)
10. **ListaGastosScreen**
    - GET /gastos con paginaciÃ³n
    - Mostrar: cÃ³digo, descripciÃ³n, monto, categorÃ­a, fecha
    - Filtros por categorÃ­a y rango de fechas

11. **CrearGastoScreen**
    - POST /gastos
    - Formulario: descripciÃ³n, monto, categorÃ­a, fecha
    - CategorÃ­as: FIJOS, VARIABLES, COMPRAS

12. **EditarGastoScreen**
    - PUT /gastos/{codigo_gasto}
    - Editar monto, descripciÃ³n, categorÃ­a

13. **BuscarGastosScreen**
    - POST /gastos/buscar
    - BÃºsqueda por: descripciÃ³n, categorÃ­a, fecha, monto

### FASE 5: Dashboard y AnalÃ­tica (CRÃTICO - LEER CON ATENCIÃ“N)
14. **DashboardPage**
    - GET /analitica?periodo=semana (consultar datos pre-calculados)
    - Tarjetas KPI: Total ventas hoy, ingresos del mes, productos sin stock, gastos del mes
    - GrÃ¡fico de ventas (Ãºltimos 7 dÃ­as)
    - Alertas recientes (top 3) con severidad
    - Botones rÃ¡pidos: Registrar venta, Ver analÃ­tica completa, Generar reporte

15. **AnaliticaPage** (âš ï¸ IMPORTANTE: NO LLAMAR ActualizarAnalitica)
    - GET /analitica?periodo=semana (SOLO CONSULTAR)
    - Tabs: DÃ­a, Semana (default), Mes
    - **âŒ NUNCA HACER ESTO:** POST /analitica (endpoint NO EXISTE pÃºblicamente)
    - **âœ… CORRECTO:** ActualizarAnalitica se ejecuta SOLO por EventBridge cada 4 horas
    - **âœ… CORRECTO:** WebSocket notifica 'analitica_actualizada' â†’ refetch GET /analitica
    - **âœ… CORRECTO:** El tenant_id NO se envÃ­a, el backend lo extrae del JWT
    
    MÃ©tricas a mostrar:
    - Ventas totales (con grÃ¡fico de lÃ­nea)
    - Ganancias brutas/netas
    - Promedio de venta
    - Productos mÃ¡s vendidos (top 5, grÃ¡fico de barras)
    - Ventas diarias (grÃ¡fico de lÃ­nea)
    - Alertas automÃ¡ticas:
      * Ventas cero en periodo (CRITICAL)
      * Ganancia baja < 10% de ingresos (WARNING)
      * Productos sin stock (CRITICAL)
      * Stock bajo â‰¤ 5 unidades (WARNING)

16. **GrÃ¡ficos (react-native-chart-kit o Victory Native)**
    - LineChart para ventas diarias
    - BarChart para productos top
    - PieChart para distribuciÃ³n de ventas por categorÃ­a

### FASE 6: Reportes (Exclusivo ADMIN)
17. **GenerarReportesScreen**
    - 4 botones: Inventario, Ventas, Gastos, General
    - Formulario para reportes de periodo (fecha_inicio, fecha_fin)
    - POST /reportes/{tipo}
    - Mostrar download_url generado
    - BotÃ³n para abrir URL (Linking.openURL)

18. **HistorialReportesScreen**
    - GET /reportes/historial
    - Lista de reportes generados
    - Mostrar: cÃ³digo, tipo, fecha, tamaÃ±o
    - BotÃ³n descargar en cada item
    - **IMPORTANTE:** Los URLs son presigned (expiran en 1h), se regeneran en cada consulta

### FASE 7: Predicciones ML (Exclusivo ADMIN)
19. **PrediccionDemandaScreen**
    - Selector de producto (dropdown o autocomplete)
    - POST /predicciones con codigo_producto
    - Mostrar:
      - Demanda maÃ±ana (unidades)
      - Demanda prÃ³xima semana (7 dÃ­as)
      - Stock actual vs demanda â†’ alerta si stock < demanda
    - GrÃ¡fico de predicciÃ³n (7 dÃ­as)
    - BotÃ³n "Reabastecer" que navega a EditarProductoScreen con stock sugerido

### FASE 8: Notificaciones y WebSocket (CRÃTICO)
20. **NotificacionesScreen** (similar a TRABAJADOR pero con mÃ¡s tipos)
    - GET /notificacion
    - Tipos de alertas:
      - stock_bajo, sin_stock
      - venta_registrada
      - ganancia_baja
      - ventas_cero
      - stockBajoManana, stockBajoProximaSemana (predicciones)
    - Badge con contador de no leÃ­das
    - Severidad: INFO, WARNING, CRITICAL

21. **WebSocket Service Completo**
    - Conectar al login
    - Eventos a escuchar:
      - venta_registrada â†’ refetch ventas + analÃ­tica
      - analitica_actualizada â†’ refetch analÃ­tica
      - prediccion_generada â†’ refetch predicciÃ³n
      - producto_actualizado â†’ refetch productos
    - Mostrar notificaciones push nativas
    - Actualizar badge

---

## ğŸ’¡ TIPS ESPECÃFICOS ADMIN

### 1. AnalÃ­tica - NO Actualizar Manualmente (âš ï¸ MUY IMPORTANTE)
```javascript
// âŒ âŒ âŒ INCORRECTO - NUNCA HAGAS ESTO âŒ âŒ âŒ
const actualizarAnalitica = () => {
  // Este endpoint NO EXISTE pÃºblicamente
  return api.post('/analitica'); // âŒ ERROR 403
};

// âœ… âœ… âœ… CORRECTO - SOLO CONSULTAR âœ… âœ… âœ…
const fetchAnalitica = (periodo = 'semana') => {
  // El backend actualiza analÃ­tica cada 4 horas con EventBridge
  // El tenant_id NO se envÃ­a, el backend lo extrae del JWT
  return api.get('/analitica', { params: { periodo } });
};

// âœ… CORRECTO: Refetch cuando WebSocket notifica
const setupWebSocket = () => {
  ws.onmessage = (event) => {
    const { event_type } = JSON.parse(event.data);
    
    if (event_type === 'analitica_actualizada') {
      // EventBridge acaba de actualizar la analÃ­tica
      fetchAnalitica().then(data => {
        setAnaliticaData(data);
      });
    }
  };
};

// âœ… RESUMEN:
// 1. EventBridge ejecuta ActualizarAnalitica cada 4 horas (automÃ¡tico)
// 2. ActualizarAnalitica calcula mÃ©tricas y guarda en t_analitica
// 3. ActualizarAnalitica emite evento WebSocket 'analitica_actualizada'
// 4. Frontend escucha evento y hace GET /analitica (refetch)
// 5. VerAnalitica (GET) consulta t_analitica (NO recalcula)
```
```

### 2. Reportes - CSV con Presigned URLs (Expiran en 1h)
```javascript
// âœ… CORRECTO: Generar reporte y abrir/descargar CSV
const generarReporte = async (tipo, fechas) => {
  // tipo: 'inventario', 'ventas', 'gastos', 'general'
  // Los reportes son CSV (NO Excel), para mejor compatibilidad
  const response = await api.post(`/reportes/${tipo}`, fechas);
  const { download_url, codigo_reporte } = response.data.data;
  
  // OpciÃ³n 1: Abrir en nueva pestaÃ±a (descarga automÃ¡tica)
  window.open(download_url, '_blank');
  
  // OpciÃ³n 2: Descargar con fetch
  const link = document.createElement('a');
  link.href = download_url;
  link.download = `${tipo}_${codigo_reporte}.csv`;
  link.click();
};

// âš ï¸ IMPORTANTE: Los presigned URLs expiran en 1 hora
// En HistorialReportesPage, el backend genera URLs FRESCOS en cada GET
const fetchHistorialReportes = async () => {
  // Los download_url son regenerados en cada consulta
  const response = await api.get('/reportes/historial');
  const reportes = response.data.data.reportes;
  
  // Cada reporte tiene un download_url FRESCO (expira en 1h)
  return reportes;
};

// âŒ NO HAGAS ESTO: NO guardes URLs en localStorage
// localStorage.setItem('download_url', url); // âŒ Se vence despuÃ©s de 1h

// âœ… SIEMPRE refetch el historial para obtener URLs frescos
```

### 3. Predicciones ML - Cache y TTL
```javascript
// âœ… Las predicciones tienen cache de 24h en backend
// No es necesario guardarlas en frontend, siempre hacer POST /predicciones

const predecirDemanda = async (codigo_producto) => {
  const response = await api.post('/predicciones', { codigo_producto });
  const { demanda_manana, demanda_proxima_semana } = response.data.data;
  
  // Comparar con stock actual
  const producto = await api.get(`/productos/${codigo_producto}`);
  const stockActual = producto.data.data.stock;
  
  if (stockActual < demanda_manana) {
    Alert.alert('âš ï¸ Stock Bajo', 'El stock no es suficiente para maÃ±ana');
  }
};
```

### 4. Usuarios - Roles
```javascript
// Roles permitidos: 'admin' y 'worker'
const crearUsuario = async (data) => {
  const usuario = {
    nombre: data.nombre,
    email: data.email,
    password: data.password,
    rol: data.rol // 'admin' o 'worker'
  };
  
  await api.post('/usuarios', usuario);
};
```

### 5. Gastos - CategorÃ­as
```javascript
// CategorÃ­as fijas en backend
const CATEGORIAS_GASTOS = [
  'FIJOS',      // Alquiler, servicios, etc.
  'VARIABLES',  // Mantenimiento, publicidad, etc.
  'COMPRAS'     // MercaderÃ­a, insumos, etc.
];

// Usar en formulario CrearGastoScreen
<Picker selectedValue={categoria} onValueChange={setCategoria}>
  {CATEGORIAS_GASTOS.map(cat => (
    <Picker.Item key={cat} label={cat} value={cat} />
  ))}
</Picker>
```

### 6. Dashboard - KPIs en Tiempo Real
```javascript
// Calcular KPIs localmente desde analÃ­tica
const calcularKPIs = (analitica) => {
  return {
    ventasHoy: analitica.periodo.dia.ventas_totales,
    ingresosHoy: analitica.periodo.dia.ingresos,
    gananciaMes: analitica.periodo.mes.ganancia_neta,
    productosSinStock: analitica.alertas.filter(a => a.tipo === 'sin_stock').length
  };
};

// Actualizar dashboard cuando llega evento WebSocket
useEffect(() => {
  if (eventType === 'analitica_actualizada') {
    fetchAnalitica().then(data => {
      setKPIs(calcularKPIs(data));
    });
  }
}, [eventType]);
```

### 7. GrÃ¡ficos - Formatear Datos
```javascript
// Formatear ventas diarias para LineChart
const formatearVentasDiarias = (ventasDiarias) => {
  return {
    labels: ventasDiarias.map(v => v.fecha.slice(5, 10)), // MM-DD
    datasets: [{
      data: ventasDiarias.map(v => v.total)
    }]
  };
};

// Usar en react-native-chart-kit
<LineChart
  data={formatearVentasDiarias(analitica.ventas_diarias)}
  width={Dimensions.get('window').width - 40}
  height={220}
  chartConfig={{...}}
/>
```

---

## ğŸ“Š FEATURES EXCLUSIVAS ADMIN

### Dashboard Ejecutivo
- KPIs en tarjetas: ventas hoy, ingresos mes, productos sin stock, gastos mes
- GrÃ¡fico de ventas (Ãºltimos 7 dÃ­as)
- Alertas recientes (top 3)
- Accesos rÃ¡pidos

### AnalÃ­tica Completa
- 3 periodos: dÃ­a, semana, mes
- MÃ©tricas: ventas, ingresos, gastos, ganancias, promedio venta
- Productos top vendidos
- GrÃ¡fico de ventas diarias
- Alertas automÃ¡ticas (generadas cada 4h por EventBridge)

### Reportes Excel
- 4 tipos: Inventario, Ventas, Gastos, General
- Descarga directa desde S3
- Historial de reportes generados

### Predicciones ML
- Demanda predicha (maÃ±ana + 7 dÃ­as)
- Alertas de stock bajo segÃºn predicciÃ³n
- Sugerencias de reabastecimiento

### GestiÃ³n de Usuarios
- CRUD completo
- Roles: admin y worker
- Soft delete (estado INACTIVO)

### GestiÃ³n de Gastos
- CRUD completo
- CategorÃ­as: FIJOS, VARIABLES, COMPRAS
- BÃºsqueda y filtros avanzados

---

## âš ï¸ ERRORES COMUNES A EVITAR

1. **NO llames a ActualizarAnalitica** (endpoint no existe pÃºblicamente, solo EventBridge)
2. **NO guardes reportes en local** (los URLs expiran, siempre refetch historial)
3. **NO caches predicciones en frontend** (backend tiene cache de 24h, siempre POST)
4. **NO permitas crear usuarios con rol 'saai'** (solo admin y worker)
5. **NO permitas gastos con monto negativo**
6. **NO muestres UUIDs** al usuario (solo cÃ³digos)
7. **NO ignores eventos WebSocket** (actualiza UI en tiempo real)
8. **NO uses categorÃ­as hardcodeadas** diferentes a las del backend

---

## ğŸ¨ UI/UX RECOMENDACIONES CON TAILWIND CSS

1. **Layout Principal:**
   - Navbar superior: logo, nombre tienda, notificaciones (badge), perfil
   - Sidebar izquierdo (desktop) con 9 mÃ³dulos:
     * ğŸ  Dashboard
     * ğŸ“¦ Productos
     * ğŸ’° Ventas
     * ğŸ‘¥ Usuarios
     * ğŸ’¸ Gastos
     * ğŸ“Š AnalÃ­tica
     * ğŸ“ Reportes
     * ğŸ”® Predicciones
     * ğŸ”” Notificaciones
   - MenÃº hamburguesa (mobile)
   - Contenido: `<main className="p-6 lg:ml-64 mt-16">`

2. **Dashboard - KPI Cards (Tailwind):**
   ```jsx
   <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
     <div className="bg-white rounded-lg shadow-md p-6">
       <div className="flex items-center justify-between">
         <div>
           <p className="text-gray-500 text-sm">Ventas Hoy</p>
           <p className="text-3xl font-bold text-gray-900">S/ 1,234.50</p>
         </div>
         <div className="bg-blue-100 rounded-full p-3">
           <svg className="w-8 h-8 text-blue-600" />  
         </div>
       </div>
       <p className="text-green-600 text-sm mt-2">
         â†‘ 12% vs ayer
       </p>
     </div>
   </div>
   ```

3. **GrÃ¡ficos - Chart.js con Tailwind:**
   ```bash
   npm install chart.js react-chartjs-2
   ```
   ```jsx
   // LineChart.jsx
   import { Line } from 'react-chartjs-2';
   
   <div className="bg-white rounded-lg shadow-md p-6">
     <h3 className="text-lg font-semibold mb-4">Ventas Diarias</h3>
     <Line 
       data={chartData} 
       options={{
         responsive: true,
         plugins: {
           legend: { display: false }
         }
       }}
     />
   </div>
   ```

4. **Tablas Responsive:**
   ```jsx
   <div className="overflow-x-auto bg-white rounded-lg shadow">
     <table className="min-w-full divide-y divide-gray-200">
       <thead className="bg-gray-50">
         <tr>
           <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
             CÃ³digo
           </th>
           <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">
             Nombre
           </th>
         </tr>
       </thead>
       <tbody className="bg-white divide-y divide-gray-200">
         <tr className="hover:bg-gray-50">
           <td className="px-6 py-4 whitespace-nowrap text-sm">T001P001</td>
           <td className="px-6 py-4 whitespace-nowrap text-sm">Coca Cola</td>
         </tr>
       </tbody>
     </table>
   </div>
   ```

5. **Alertas - Badges por Severidad:**
   ```jsx
   const SeverityBadge = ({ severity }) => {
     const colors = {
       CRITICAL: 'bg-red-100 text-red-800',
       WARNING: 'bg-yellow-100 text-yellow-800',
       INFO: 'bg-blue-100 text-blue-800'
     };
     
     return (
       <span className={`px-2 py-1 text-xs font-semibold rounded-full ${colors[severity]}`}>
         {severity}
       </span>
     );
   };
   ```

6. **Modal con Tailwind (Overlay + Card):**
   ```jsx
   {showModal && (
     <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
       <div className="bg-white rounded-lg p-6 max-w-md w-full">
         <h2 className="text-xl font-bold mb-4">Crear Producto</h2>
         {/* Formulario */}
         <div className="flex justify-end space-x-2">
           <button className="px-4 py-2 bg-gray-200 rounded-lg">Cancelar</button>
           <button className="px-4 py-2 bg-blue-600 text-white rounded-lg">Guardar</button>
         </div>
       </div>
     </div>
   )}
   ```

7. **Tabs:**
   ```jsx
   <div className="border-b border-gray-200">
     <nav className="flex space-x-8">
       <button className="py-4 px-1 border-b-2 border-blue-600 text-blue-600 font-medium">
         Semana
       </button>
       <button className="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700">
         Mes
       </button>
     </nav>
   </div>
   ```

8. **Colores por Estado:**
   - ACTIVO: `bg-green-100 text-green-800`
   - INACTIVO: `bg-red-100 text-red-800`
   - Alerta CRITICAL: `bg-red-600 text-white`
   - Alerta WARNING: `bg-yellow-500 text-white`
   - Alerta INFO: `bg-blue-500 text-white`

---

## âœ… CHECKLIST DE IMPLEMENTACIÃ“N

- [ ] LoginScreen + AuthContext
- [ ] DrawerNavigator
- [ ] DashboardScreen con KPIs
- [ ] MÃ³dulo Productos completo
- [ ] MÃ³dulo Ventas completo
- [ ] MÃ³dulo Usuarios completo
- [ ] MÃ³dulo Gastos completo
- [ ] AnaliticaScreen con grÃ¡ficos
- [ ] WebSocket listener para 'analitica_actualizada'
- [ ] GenerarReportesScreen (4 tipos)
- [ ] HistorialReportesScreen
- [ ] PrediccionDemandaScreen
- [ ] NotificacionesScreen
- [ ] WebSocket service completo
- [ ] Error handling global
- [ ] Loading states
- [ ] Pull-to-refresh en listas
- [ ] Testing en dispositivo real

---

## ğŸš¦ COMENZAR AHORA

**Primer paso:** Lee SAAI_oficial.txt secciÃ³n "3. Arquitectura ADMINISTRADOR" completa (especialmente AnalÃ­tica).

**Segundo paso:** Revisa Postman collection mÃ³dulos: AUTH, USUARIOS, GASTOS, ANALYTICS, REPORTES, PREDICCIONES.

**Tercer paso:** Implementa LoginScreen + AuthContext + DrawerNavigator (FASE 1).

**Cuarto paso:** Implementa DashboardScreen con KPIs bÃ¡sicos (FASE 5.14).

**Pregunta clave:** Â¿Entendiste que ActualizarAnalitica NO se llama desde frontend y que WebSocket notifica cuando hay datos nuevos?

---

Â¡Empecemos con el mÃ³dulo mÃ¡s complejo! Dime cuando hayas leÃ­do los archivos de referencia y estÃ©s listo para implementar el DashboardScreen con analÃ­tica.
